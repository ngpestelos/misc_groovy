Based on Groovy Recipes (Chapter 10)